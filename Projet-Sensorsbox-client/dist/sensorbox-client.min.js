/*! sensorbox-client 25-05-2014 */
!function(){var a=function(){};a.prototype.on=function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},a.prototype.off=function(a,b){this._events=this._events||{},a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)},a.prototype.emit=function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))},a.inherits=function(b){for(var c=["on","off","emit"],d=0;d<c.length;d++)"function"==typeof b?b.prototype[c[d]]=a.prototype[c[d]]:b[c[d]]=a.prototype[c[d]]},window.EventEmitter=a}(),function(){var a=function(a){a=a||{},window.io.sails.url=this.host=a.host||"http://beta.sensorsbox.com:80",this.verbose=a.verbose||!1,EventEmitter.inherits(this),this.watchedBoxes=[],this.watchedSensors=[]},b=function(a){io.socket.on("measure",function(b){a.verbose&&console.log(b),a.watchedSensors.indexOf(b.created.sensor)>-1&&a.emit("measure",b)})};a.prototype.watchBox=function(a,c){var d=this,e="/api/v1/realtime/box/";this.watchedBoxes.indexOf(a)>-1?c(new Error("You are already watching this box!")):io.socket.get(this.host+e+a,function(a){d.verbose&&console.log("Watching all the sensors attached to the box..."),b(d),d.watchedBoxes.push(a.id),a.sensor.forEach(function(a){d.watchedSensors.push(a.id)}),c(null,a)})},a.prototype.watchSensor=function(a,c){var d=this,e="/api/v1/realtime/sensor/";this.watchedSensors.indexOf(a)>-1?c(new Error("You are already watching this sensor!")):io.socket.get(this.host+e+a,function(a){d.verbose&&console.log("Watching the sensor..."),b(d),d.watchedSensors.push(a.id),c(null,a)})},window.SensorsBox=a}();